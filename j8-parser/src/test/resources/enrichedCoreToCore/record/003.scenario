-- Update record
typealias Person =
  { name : String
  , dateOfBirth :
    { day : Int
    , month : Int
    , year : Int
    }
  }

value1 : Person -> Person
value1 person =
  { person | name = "Andrew" }

value2 : Person -> Int -> Person
value2 person newDay =
  { person | dateOfBirth = { person.dateOfBirth | day = newDay } }
-- coreASTpp
typealias Person =
  <> {name : Data.String, dateOfBirth : {day : Data.Int, month : Data.Int, year : Data.Int}}

value1 : <> alias.Person -> alias.Person
value1 =
  (LAMBDA person ->
    (LET
      $record : <> {dateOfBirth : {day : Data.Int, month : Data.Int, year : Data.Int}, name : Data.String}
      $record =
        person

      {
       name =
        "Andrew"
       dateOfBirth =
        $record
         .dateOfBirth)
      }
    )
  )


value2 : <> alias.Person -> Data.Int -> alias.Person
value2 =
  (LAMBDA person ->
    (LAMBDA newDay ->
      (LET
        $record : <> {name : Data.String, dateOfBirth : {day : Data.Int, month : Data.Int, year : Data.Int}}
        $record =
          person

        {
         name =
          $record
           .name)
         dateOfBirth =
          (LET
            $record : <> {day : Data.Int, month : Data.Int, year : Data.Int}
            $record =
              person
               .dateOfBirth)

            {
             day =
              newDay
             month =
              $record
               .month)
             year =
              $record
               .year)
            }
          )
        }
      )
    )
  )