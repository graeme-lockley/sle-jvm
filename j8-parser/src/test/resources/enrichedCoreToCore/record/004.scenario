-- Update record
typealias Person =
  { name : String
  , dateOfBirth :
    { day : Int
    , month : Int
    , year : Int
    }
  }


extractName : Person -> String
extractName person =
  person.name


value =
  { name = "Graeme"
  , dateOfBirth =
    { day = 9
    , month = 4
    , year = 1968
    }
  }


main =
  extractName { value | name = "Andrew" }
-- coreAST
ParseDetail:
  environment:
    Environment:
      typeBindings: {
          Int ->
                    BuiltinBinding:
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TCon:
                      arguments: []
                      name: Data.Int
          Bool ->
                    BuiltinBinding:
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TCon:
                      arguments: []
                      name: Data.Bool
          String ->
                    BuiltinBinding:
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TCon:
                      arguments: []
                      name: Data.String
          Char ->
                    BuiltinBinding:
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TCon:
                      arguments: []
                      name: Data.Char
          () ->
                    BuiltinBinding:
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TCon:
                      arguments: []
                      name: Data.Unit
          Person ->
                    AliasBinding:
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TRec:
                      fields: [
                          Pair:
                            first: name
                            second:
                              TCon:
                                arguments: []
                                name: Data.String
                          Pair:
                            first: dateOfBirth
                            second:
                              TRec:
                                fields: [
                                    Pair:
                                      first: day
                                      second:
                                        TCon:
                                          arguments: []
                                          name: Data.Int
                                    Pair:
                                      first: month
                                      second:
                                        TCon:
                                          arguments: []
                                          name: Data.Int
                                    Pair:
                                      first: year
                                      second:
                                        TCon:
                                          arguments: []
                                          name: Data.Int
                                  ]
                                fixed: true
                        ]
                      fixed: true
        }
      valueBindings: {
          + ->
                    OperatorBinding:
              associativity:
                Left:
              precedence: 6
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TArr:
                      domain:
                        TCon:
                          arguments: []
                          name: Data.Int
                      range:
                        TArr:
                          domain:
                            TCon:
                              arguments: []
                              name: Data.Int
                          range:
                            TCon:
                              arguments: []
                              name: Data.Int
          - ->
                    OperatorBinding:
              associativity:
                Left:
              precedence: 6
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TArr:
                      domain:
                        TCon:
                          arguments: []
                          name: Data.Int
                      range:
                        TArr:
                          domain:
                            TCon:
                              arguments: []
                              name: Data.Int
                          range:
                            TCon:
                              arguments: []
                              name: Data.Int
          * ->
                    OperatorBinding:
              associativity:
                Left:
              precedence: 7
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TArr:
                      domain:
                        TCon:
                          arguments: []
                          name: Data.Int
                      range:
                        TArr:
                          domain:
                            TCon:
                              arguments: []
                              name: Data.Int
                          range:
                            TCon:
                              arguments: []
                              name: Data.Int
          / ->
                    OperatorBinding:
              associativity:
                Left:
              precedence: 7
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TArr:
                      domain:
                        TCon:
                          arguments: []
                          name: Data.Int
                      range:
                        TArr:
                          domain:
                            TCon:
                              arguments: []
                              name: Data.Int
                          range:
                            TCon:
                              arguments: []
                              name: Data.Int
          && ->
                    OperatorBinding:
              associativity:
                Right:
              precedence: 3
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TArr:
                      domain:
                        TCon:
                          arguments: []
                          name: Data.Bool
                      range:
                        TArr:
                          domain:
                            TCon:
                              arguments: []
                              name: Data.Bool
                          range:
                            TCon:
                              arguments: []
                              name: Data.Bool
          == ->
                    OperatorBinding:
              associativity:
                None:
              precedence: 4
              scheme:
                Scheme:
                  parameters: [
                      1
                    ]
                  type:
                    TArr:
                      domain:
                        TVar:
                          variable: 1
                      range:
                        TArr:
                          domain:
                            TVar:
                              variable: 1
                          range:
                            TCon:
                              arguments: []
                              name: Data.Bool
          aString ->
                    VariableBinding:
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TCon:
                      arguments: []
                      name: Data.String
          extractName ->
                    VariableBinding:
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TArr:
                      domain:
                        TAlias:
                          arguments: []
                          name: Person
                      range:
                        TCon:
                          arguments: []
                          name: Data.String
          value ->
                    VariableBinding:
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TRec:
                      fields: [
                          Pair:
                            first: name
                            second:
                              TCon:
                                arguments: []
                                name: Data.String
                          Pair:
                            first: dateOfBirth
                            second:
                              TRec:
                                fields: [
                                    Pair:
                                      first: day
                                      second:
                                        TCon:
                                          arguments: []
                                          name: Data.Int
                                    Pair:
                                      first: month
                                      second:
                                        TCon:
                                          arguments: []
                                          name: Data.Int
                                    Pair:
                                      first: year
                                      second:
                                        TCon:
                                          arguments: []
                                          name: Data.Int
                                  ]
                                fixed: true
                        ]
                      fixed: true
          main ->
                    VariableBinding:
              scheme:
                Scheme:
                  parameters: []
                  type:
                    TCon:
                      arguments: []
                      name: Data.String
        }
  module:
    Module:
      declarations: [
          TypeAliasDeclaration:
            name:
              ID:
                name: Person
            scheme:
              Scheme:
                parameters: []
                type:
                  TRec:
                    fields: [
                        Pair:
                          first: name
                          second:
                            TCon:
                              arguments: []
                              name: Data.String
                        Pair:
                          first: dateOfBirth
                          second:
                            TRec:
                              fields: [
                                  Pair:
                                    first: day
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                  Pair:
                                    first: month
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                  Pair:
                                    first: year
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                ]
                              fixed: true
                      ]
                    fixed: true
          LetDeclaration:
            expression:
              LambdaExpression:
                argument:
                  ID:
                    name: person
                expression:
                  FieldProjectionExpression:
                    name:
                      ID:
                        name: name
                    record:
                      IdReference:
                        name: person
                        type:
                          TAlias:
                            arguments: []
                            name: Person
                    type:
                      TCon:
                        arguments: []
                        name: Data.String
                type:
                  TArr:
                    domain:
                      TAlias:
                        arguments: []
                        name: Person
                    range:
                      TCon:
                        arguments: []
                        name: Data.String
            id:
              LowerIDDeclarationID:
                name:
                  ID:
                    name: extractName
            scheme:
              Scheme:
                parameters: []
                type:
                  TArr:
                    domain:
                      TAlias:
                        arguments: []
                        name: Person
                    range:
                      TCon:
                        arguments: []
                        name: Data.String
          LetDeclaration:
            expression:
              ConstantRecord:
                fields: [
                    ConstantField:
                      name:
                        ID:
                          name: name
                      value:
                        ConstantString:
                          type:
                            TCon:
                              arguments: []
                              name: Data.String
                          value: Graeme
                    ConstantField:
                      name:
                        ID:
                          name: dateOfBirth
                      value:
                        ConstantRecord:
                          fields: [
                              ConstantField:
                                name:
                                  ID:
                                    name: day
                                value:
                                  ConstantInt:
                                    type:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                    value: 9
                              ConstantField:
                                name:
                                  ID:
                                    name: month
                                value:
                                  ConstantInt:
                                    type:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                    value: 4
                              ConstantField:
                                name:
                                  ID:
                                    name: year
                                value:
                                  ConstantInt:
                                    type:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                    value: 1968
                            ]
                          type:
                            TRec:
                              fields: [
                                  Pair:
                                    first: day
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                  Pair:
                                    first: month
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                  Pair:
                                    first: year
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                ]
                              fixed: true
                  ]
                type:
                  TRec:
                    fields: [
                        Pair:
                          first: name
                          second:
                            TCon:
                              arguments: []
                              name: Data.String
                        Pair:
                          first: dateOfBirth
                          second:
                            TRec:
                              fields: [
                                  Pair:
                                    first: day
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                  Pair:
                                    first: month
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                  Pair:
                                    first: year
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                ]
                              fixed: true
                      ]
                    fixed: true
            id:
              LowerIDDeclarationID:
                name:
                  ID:
                    name: value
            scheme:
              Scheme:
                parameters: []
                type:
                  TRec:
                    fields: [
                        Pair:
                          first: name
                          second:
                            TCon:
                              arguments: []
                              name: Data.String
                        Pair:
                          first: dateOfBirth
                          second:
                            TRec:
                              fields: [
                                  Pair:
                                    first: day
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                  Pair:
                                    first: month
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                  Pair:
                                    first: year
                                    second:
                                      TCon:
                                        arguments: []
                                        name: Data.Int
                                ]
                              fixed: true
                      ]
                    fixed: true
          LetDeclaration:
            expression:
              CallExpression:
                operand:
                  LetExpression:
                    declarations: [
                        LetDeclaration:
                          expression:
                            IdReference:
                              name: value
                              type:
                                TRec:
                                  fields: [
                                      Pair:
                                        first: name
                                        second:
                                          TCon:
                                            arguments: []
                                            name: Data.String
                                      Pair:
                                        first: dateOfBirth
                                        second:
                                          TRec:
                                            fields: [
                                                Pair:
                                                  first: day
                                                  second:
                                                    TCon:
                                                      arguments: []
                                                      name: Data.Int
                                                Pair:
                                                  first: month
                                                  second:
                                                    TCon:
                                                      arguments: []
                                                      name: Data.Int
                                                Pair:
                                                  first: year
                                                  second:
                                                    TCon:
                                                      arguments: []
                                                      name: Data.Int
                                              ]
                                            fixed: true
                                    ]
                                  fixed: true
                          id:
                            LowerIDDeclarationID:
                              name:
                                ID:
                                  name: $record
                          scheme:
                            Scheme:
                              parameters: []
                              type:
                                TRec:
                                  fields: [
                                      Pair:
                                        first: name
                                        second:
                                          TCon:
                                            arguments: []
                                            name: Data.String
                                      Pair:
                                        first: dateOfBirth
                                        second:
                                          TRec:
                                            fields: [
                                                Pair:
                                                  first: day
                                                  second:
                                                    TCon:
                                                      arguments: []
                                                      name: Data.Int
                                                Pair:
                                                  first: month
                                                  second:
                                                    TCon:
                                                      arguments: []
                                                      name: Data.Int
                                                Pair:
                                                  first: year
                                                  second:
                                                    TCon:
                                                      arguments: []
                                                      name: Data.Int
                                              ]
                                            fixed: true
                                    ]
                                  fixed: true
                      ]
                    expression:
                      ConstantRecord:
                        fields: [
                            ConstantField:
                              name:
                                ID:
                                  name: name
                              value:
                                ConstantString:
                                  type:
                                    TCon:
                                      arguments: []
                                      name: Data.String
                                  value: Andrew
                            ConstantField:
                              name:
                                ID:
                                  name: dateOfBirth
                              value:
                                FieldProjectionExpression:
                                  name:
                                    ID:
                                      name: dateOfBirth
                                  record:
                                    IdReference:
                                      name: $record
                                      type:
                                        TRec:
                                          fields: [
                                              Pair:
                                                first: name
                                                second:
                                                  TCon:
                                                    arguments: []
                                                    name: Data.String
                                              Pair:
                                                first: dateOfBirth
                                                second:
                                                  TRec:
                                                    fields: [
                                                        Pair:
                                                          first: day
                                                          second:
                                                            TCon:
                                                              arguments: []
                                                              name: Data.Int
                                                        Pair:
                                                          first: month
                                                          second:
                                                            TCon:
                                                              arguments: []
                                                              name: Data.Int
                                                        Pair:
                                                          first: year
                                                          second:
                                                            TCon:
                                                              arguments: []
                                                              name: Data.Int
                                                      ]
                                                    fixed: true
                                            ]
                                          fixed: true
                                  type:
                                    TRec:
                                      fields: [
                                          Pair:
                                            first: day
                                            second:
                                              TCon:
                                                arguments: []
                                                name: Data.Int
                                          Pair:
                                            first: month
                                            second:
                                              TCon:
                                                arguments: []
                                                name: Data.Int
                                          Pair:
                                            first: year
                                            second:
                                              TCon:
                                                arguments: []
                                                name: Data.Int
                                        ]
                                      fixed: true
                          ]
                        type:
                          TRec:
                            fields: [
                                Pair:
                                  first: name
                                  second:
                                    TCon:
                                      arguments: []
                                      name: Data.String
                                Pair:
                                  first: dateOfBirth
                                  second:
                                    TRec:
                                      fields: [
                                          Pair:
                                            first: day
                                            second:
                                              TCon:
                                                arguments: []
                                                name: Data.Int
                                          Pair:
                                            first: month
                                            second:
                                              TCon:
                                                arguments: []
                                                name: Data.Int
                                          Pair:
                                            first: year
                                            second:
                                              TCon:
                                                arguments: []
                                                name: Data.Int
                                        ]
                                      fixed: true
                              ]
                            fixed: true
                    type:
                      TRec:
                        fields: [
                            Pair:
                              first: name
                              second:
                                TCon:
                                  arguments: []
                                  name: Data.String
                            Pair:
                              first: dateOfBirth
                              second:
                                TRec:
                                  fields: [
                                      Pair:
                                        first: day
                                        second:
                                          TCon:
                                            arguments: []
                                            name: Data.Int
                                      Pair:
                                        first: month
                                        second:
                                          TCon:
                                            arguments: []
                                            name: Data.Int
                                      Pair:
                                        first: year
                                        second:
                                          TCon:
                                            arguments: []
                                            name: Data.Int
                                    ]
                                  fixed: true
                          ]
                        fixed: true
                operator:
                  IdReference:
                    name: extractName
                    type:
                      TArr:
                        domain:
                          TAlias:
                            arguments: []
                            name: Person
                        range:
                          TCon:
                            arguments: []
                            name: Data.String
                type:
                  TCon:
                    arguments: []
                    name: Data.String
            id:
              LowerIDDeclarationID:
                name:
                  ID:
                    name: main
            scheme:
              Scheme:
                parameters: []
                type:
                  TCon:
                    arguments: []
                    name: Data.String
        ]
      exports: []
-- coreASTpp
typealias Person =
  <> {name : Data.String, dateOfBirth : {day : Data.Int, month : Data.Int, year : Data.Int}}

extractName : <> alias.Person -> Data.String
extractName =
  (LAMBDA person ->
    person
     .name)
  )


value : <> {name : Data.String, dateOfBirth : {day : Data.Int, month : Data.Int, year : Data.Int}}
value =
  {
   name =
    "Graeme"
   dateOfBirth =
    {
     day =
      9
     month =
      4
     year =
      1968
    }
  }


main : <> Data.String
main =
  (CALL
    extractName
    (LET
      $record : <> {name : Data.String, dateOfBirth : {day : Data.Int, month : Data.Int, year : Data.Int}}
      $record =
        value

      {
       name =
        "Andrew"
       dateOfBirth =
        $record
         .dateOfBirth)
      }
    )
  )