-- A cons list declaration with operations
type List a =
    Nil
  | Cons a (List a)


repeat : Int -> a -> List a
repeat n e
    | n == 0 = Nil
    | otherwise = Cons e (repeat (n - 1) e)


singleton x =
    repeat 1 x
-- constraints
[
  '2 -> '2 -> Bool : '0 -> '3
  '3 : Int -> '4
  '6 -> List '6 -> List '6 : '1 -> '7
  Int -> Int -> Int : '0 -> '9
  '9 : Int -> '10
  Int -> '8 -> List '8 : '10 -> '11
  '11 : '1 -> '12
  '7 : '12 -> '13
  '4 : Bool
  List '5 : '13
  Int -> '14 -> List '14 : '0 -> '1 -> List '5
  Int -> '16 -> List '16 : Int -> '17
  '17 : '15 -> '18
]
-- substitution
[
  2=Int
  3=Int -> Bool
  0=Int
  4=Bool
  6='1
  7=List '1 -> List '1
  9=Int -> Int
  10=Int
  11='1 -> List '1
  8='1
  12=List '1
  13=List '1
  5='1
  14='1
  17='15 -> List '15
  16='15
  18=List '15
]
-- typeAST
Module:
  declarations: [
      TypeDeclaration:
        constructors: [
            Constructor:
              arguments: []
              name:
                ID:
                  name: Nil
            Constructor:
              arguments: [
                  TVar:
                    variable: 0
                  TCon:
                    arguments: [
                        TVar:
                          variable: 0
                      ]
                    name: List
                ]
              name:
                ID:
                  name: Cons
          ]
        name:
          ID:
            name: List
        scheme:
          Scheme:
            parameters: [
                0
              ]
            type:
              TCon:
                arguments: [
                    TVar:
                      variable: 0
                  ]
                name: List
      LetDeclaration:
        expression:
          LambdaExpression:
            argument:
              IdReferencePattern:
                name: n
                type:
                  TCon:
                    arguments: []
                    name: Int
            expression:
              LambdaExpression:
                argument:
                  IdReferencePattern:
                    name: e
                    type:
                      TVar:
                        variable: 1
                expression:
                  IfExpression:
                    elseExpression:
                      CallExpression:
                        operand:
                          CallExpression:
                            operand:
                              IdReference:
                                name: e
                                type:
                                  TVar:
                                    variable: 1
                            operator:
                              CallExpression:
                                operand:
                                  CallExpression:
                                    operand:
                                      ConstantInt:
                                        type:
                                          TCon:
                                            arguments: []
                                            name: Int
                                        value: 1
                                    operator:
                                      CallExpression:
                                        operand:
                                          IdReference:
                                            name: n
                                            type:
                                              TCon:
                                                arguments: []
                                                name: Int
                                        operator:
                                          IdReference:
                                            name: (-)
                                            type:
                                              TArr:
                                                domain:
                                                  TCon:
                                                    arguments: []
                                                    name: Int
                                                range:
                                                  TArr:
                                                    domain:
                                                      TCon:
                                                        arguments: []
                                                        name: Int
                                                    range:
                                                      TCon:
                                                        arguments: []
                                                        name: Int
                                        type:
                                          TArr:
                                            domain:
                                              TCon:
                                                arguments: []
                                                name: Int
                                            range:
                                              TCon:
                                                arguments: []
                                                name: Int
                                    type:
                                      TCon:
                                        arguments: []
                                        name: Int
                                operator:
                                  IdReference:
                                    name: repeat
                                    type:
                                      TArr:
                                        domain:
                                          TCon:
                                            arguments: []
                                            name: Int
                                        range:
                                          TArr:
                                            domain:
                                              TVar:
                                                variable: 1
                                            range:
                                              TCon:
                                                arguments: [
                                                    TVar:
                                                      variable: 1
                                                  ]
                                                name: List
                                type:
                                  TArr:
                                    domain:
                                      TVar:
                                        variable: 1
                                    range:
                                      TCon:
                                        arguments: [
                                            TVar:
                                              variable: 1
                                          ]
                                        name: List
                            type:
                              TCon:
                                arguments: [
                                    TVar:
                                      variable: 1
                                  ]
                                name: List
                        operator:
                          CallExpression:
                            operand:
                              IdReference:
                                name: e
                                type:
                                  TVar:
                                    variable: 1
                            operator:
                              IdReference:
                                name: Cons
                                type:
                                  TArr:
                                    domain:
                                      TVar:
                                        variable: 1
                                    range:
                                      TArr:
                                        domain:
                                          TCon:
                                            arguments: [
                                                TVar:
                                                  variable: 1
                                              ]
                                            name: List
                                        range:
                                          TCon:
                                            arguments: [
                                                TVar:
                                                  variable: 1
                                              ]
                                            name: List
                            type:
                              TArr:
                                domain:
                                  TCon:
                                    arguments: [
                                        TVar:
                                          variable: 1
                                      ]
                                    name: List
                                range:
                                  TCon:
                                    arguments: [
                                        TVar:
                                          variable: 1
                                      ]
                                    name: List
                        type:
                          TCon:
                            arguments: [
                                TVar:
                                  variable: 1
                              ]
                            name: List
                    guardExpression:
                      CallExpression:
                        operand:
                          ConstantInt:
                            type:
                              TCon:
                                arguments: []
                                name: Int
                            value: 0
                        operator:
                          CallExpression:
                            operand:
                              IdReference:
                                name: n
                                type:
                                  TCon:
                                    arguments: []
                                    name: Int
                            operator:
                              IdReference:
                                name: (==)
                                type:
                                  TArr:
                                    domain:
                                      TCon:
                                        arguments: []
                                        name: Int
                                    range:
                                      TArr:
                                        domain:
                                          TCon:
                                            arguments: []
                                            name: Int
                                        range:
                                          TCon:
                                            arguments: []
                                            name: Bool
                            type:
                              TArr:
                                domain:
                                  TCon:
                                    arguments: []
                                    name: Int
                                range:
                                  TCon:
                                    arguments: []
                                    name: Bool
                        type:
                          TCon:
                            arguments: []
                            name: Bool
                    thenExpression:
                      IdReference:
                        name: Nil
                        type:
                          TCon:
                            arguments: [
                                TVar:
                                  variable: 1
                              ]
                            name: List
                    type:
                      TCon:
                        arguments: [
                            TVar:
                              variable: 1
                          ]
                        name: List
                type:
                  TArr:
                    domain:
                      TVar:
                        variable: 1
                    range:
                      TCon:
                        arguments: [
                            TVar:
                              variable: 1
                          ]
                        name: List
            type:
              TArr:
                domain:
                  TCon:
                    arguments: []
                    name: Int
                range:
                  TArr:
                    domain:
                      TVar:
                        variable: 1
                    range:
                      TCon:
                        arguments: [
                            TVar:
                              variable: 1
                          ]
                        name: List
        name:
          ID:
            name: repeat
        scheme:
          Scheme:
            parameters: [
                0
              ]
            type:
              TArr:
                domain:
                  TCon:
                    arguments: []
                    name: Int
                range:
                  TArr:
                    domain:
                      TVar:
                        variable: 0
                    range:
                      TCon:
                        arguments: [
                            TVar:
                              variable: 0
                          ]
                        name: List
      LetDeclaration:
        expression:
          LambdaExpression:
            argument:
              IdReferencePattern:
                name: x
                type:
                  TVar:
                    variable: 15
            expression:
              CallExpression:
                operand:
                  IdReference:
                    name: x
                    type:
                      TVar:
                        variable: 15
                operator:
                  CallExpression:
                    operand:
                      ConstantInt:
                        type:
                          TCon:
                            arguments: []
                            name: Int
                        value: 1
                    operator:
                      IdReference:
                        name: repeat
                        type:
                          TArr:
                            domain:
                              TCon:
                                arguments: []
                                name: Int
                            range:
                              TArr:
                                domain:
                                  TVar:
                                    variable: 15
                                range:
                                  TCon:
                                    arguments: [
                                        TVar:
                                          variable: 15
                                      ]
                                    name: List
                    type:
                      TArr:
                        domain:
                          TVar:
                            variable: 15
                        range:
                          TCon:
                            arguments: [
                                TVar:
                                  variable: 15
                              ]
                            name: List
                type:
                  TCon:
                    arguments: [
                        TVar:
                          variable: 15
                      ]
                    name: List
            type:
              TArr:
                domain:
                  TVar:
                    variable: 15
                range:
                  TCon:
                    arguments: [
                        TVar:
                          variable: 15
                      ]
                    name: List
        name:
          ID:
            name: singleton
        scheme:
          Scheme:
            parameters: [
                15
              ]
            type:
              TArr:
                domain:
                  TVar:
                    variable: 15
                range:
                  TCon:
                    arguments: [
                        TVar:
                          variable: 15
                      ]
                    name: List
    ]