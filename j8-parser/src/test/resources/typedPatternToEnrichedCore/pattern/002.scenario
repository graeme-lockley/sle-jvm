-- Translate case with constant int into lambda
numToString v =
    case v of
        0 -> "0"
        1 -> "1"
        x -> "many"
-- enrichedAST
Module:
  declarations: [
      LetDeclaration:
        expression:
          LambdaExpression:
            argument:
              IdReferencePattern:
                name: v
                type:
                  TCon:
                    arguments: []
                    name: Int
            expression:
              CallExpression:
                operand:
                  IdReference:
                    name: v
                    type:
                      TCon:
                        arguments: []
                        name: Int
                operator:
                  LambdaExpression:
                    argument:
                      IdReferencePattern:
                        name: $case
                        type:
                          TCon:
                            arguments: []
                            name: Int
                    expression:
                      Bar:
                        expressions: [
                            CallExpression:
                              operand:
                                IdReference:
                                  name: $case
                                  type:
                                    TCon:
                                      arguments: []
                                      name: Int
                              operator:
                                LambdaExpression:
                                  argument:
                                    IdReferencePattern:
                                      name: $v0
                                      type:
                                        TCon:
                                          arguments: []
                                          name: Int
                                  expression:
                                    IfExpression:
                                      elseExpression:
                                        FAIL:
                                          type:
                                            TCon:
                                              arguments: []
                                              name: String
                                      guardExpression:
                                        CallExpression:
                                          operand:
                                            IdReference:
                                              name: $v0
                                              type:
                                                TCon:
                                                  arguments: []
                                                  name: Int
                                          operator:
                                            CallExpression:
                                              operand:
                                                ConstantInt:
                                                  type:
                                                    TCon:
                                                      arguments: []
                                                      name: Int
                                                  value: 0
                                              operator:
                                                IdReference:
                                                  name: (==)
                                                  type:
                                                    TArr:
                                                      domain:
                                                        TCon:
                                                          arguments: []
                                                          name: Int
                                                      range:
                                                        TArr:
                                                          domain:
                                                            TCon:
                                                              arguments: []
                                                              name: Int
                                                          range:
                                                            TCon:
                                                              arguments: []
                                                              name: Bool
                                              type:
                                                TArr:
                                                  domain:
                                                    TCon:
                                                      arguments: []
                                                      name: Int
                                                  range:
                                                    TCon:
                                                      arguments: []
                                                      name: Bool
                                          type:
                                            TCon:
                                              arguments: []
                                              name: Bool
                                      thenExpression:
                                        ConstantString:
                                          type:
                                            TCon:
                                              arguments: []
                                              name: String
                                          value: 0
                                      type:
                                        TCon:
                                          arguments: []
                                          name: String
                                  type:
                                    TArr:
                                      domain:
                                        TCon:
                                          arguments: []
                                          name: Int
                                      range:
                                        TCon:
                                          arguments: []
                                          name: String
                              type:
                                TCon:
                                  arguments: []
                                  name: String
                            CallExpression:
                              operand:
                                IdReference:
                                  name: $case
                                  type:
                                    TCon:
                                      arguments: []
                                      name: Int
                              operator:
                                LambdaExpression:
                                  argument:
                                    IdReferencePattern:
                                      name: $v0
                                      type:
                                        TCon:
                                          arguments: []
                                          name: Int
                                  expression:
                                    IfExpression:
                                      elseExpression:
                                        FAIL:
                                          type:
                                            TCon:
                                              arguments: []
                                              name: String
                                      guardExpression:
                                        CallExpression:
                                          operand:
                                            IdReference:
                                              name: $v0
                                              type:
                                                TCon:
                                                  arguments: []
                                                  name: Int
                                          operator:
                                            CallExpression:
                                              operand:
                                                ConstantInt:
                                                  type:
                                                    TCon:
                                                      arguments: []
                                                      name: Int
                                                  value: 1
                                              operator:
                                                IdReference:
                                                  name: (==)
                                                  type:
                                                    TArr:
                                                      domain:
                                                        TCon:
                                                          arguments: []
                                                          name: Int
                                                      range:
                                                        TArr:
                                                          domain:
                                                            TCon:
                                                              arguments: []
                                                              name: Int
                                                          range:
                                                            TCon:
                                                              arguments: []
                                                              name: Bool
                                              type:
                                                TArr:
                                                  domain:
                                                    TCon:
                                                      arguments: []
                                                      name: Int
                                                  range:
                                                    TCon:
                                                      arguments: []
                                                      name: Bool
                                          type:
                                            TCon:
                                              arguments: []
                                              name: Bool
                                      thenExpression:
                                        ConstantString:
                                          type:
                                            TCon:
                                              arguments: []
                                              name: String
                                          value: 1
                                      type:
                                        TCon:
                                          arguments: []
                                          name: String
                                  type:
                                    TArr:
                                      domain:
                                        TCon:
                                          arguments: []
                                          name: Int
                                      range:
                                        TCon:
                                          arguments: []
                                          name: String
                              type:
                                TCon:
                                  arguments: []
                                  name: String
                            CallExpression:
                              operand:
                                IdReference:
                                  name: $case
                                  type:
                                    TCon:
                                      arguments: []
                                      name: Int
                              operator:
                                LambdaExpression:
                                  argument:
                                    IdReferencePattern:
                                      name: x
                                      type:
                                        TCon:
                                          arguments: []
                                          name: Int
                                  expression:
                                    ConstantString:
                                      type:
                                        TCon:
                                          arguments: []
                                          name: String
                                      value: many
                                  type:
                                    TArr:
                                      domain:
                                        TCon:
                                          arguments: []
                                          name: Int
                                      range:
                                        TCon:
                                          arguments: []
                                          name: String
                              type:
                                TCon:
                                  arguments: []
                                  name: String
                            ERROR:
                              type:
                                TCon:
                                  arguments: []
                                  name: String
                          ]
                        type:
                          TCon:
                            arguments: []
                            name: String
                    type:
                      TArr:
                        domain:
                          TCon:
                            arguments: []
                            name: Int
                        range:
                          TCon:
                            arguments: []
                            name: String
                type:
                  TCon:
                    arguments: []
                    name: String
            type:
              TArr:
                domain:
                  TCon:
                    arguments: []
                    name: Int
                range:
                  TCon:
                    arguments: []
                    name: String
        name:
          ID:
            name: numToString
        scheme:
          Scheme:
            parameters: []
            type:
              TArr:
                domain:
                  TCon:
                    arguments: []
                    name: Int
                range:
                  TCon:
                    arguments: []
                    name: String
    ]